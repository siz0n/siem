server:
  host: "127.0.0.1"
  port: 5000

agent:
  id: "agent-ubuntu-01"
  database: "mydb"

data_dir: "./data"

sources:
  auditd:
    enabled: true
    path: "/var/log/audit/audit.log"
  syslog:
    enabled: true
    path: "/var/log/syslog"
  auth:
    enabled: true
    path: "/var/log/auth.log"
  bash_history:
    enabled: true
    path: "~/.bash_history"

send:
  interval_sec: 1
  batch_size: 1
  ram_ring_capacity: 1

filter:
  min_severity: "low"
  drop_empty_raw: true
  rate_limit_window_sec: 3
  dedupe_bash_history: true

  keep_if_raw_contains:
    - "DENIED"
    - "success=no"
    - "Failed password"
    - "Invalid user"
    - "sudo:"

  drop_process_contains:
    - "gnome-shell"
    - "rtkit-daemon"
    - "fwupd"

  drop_event_types:
    - "syslog_raw"

  drop_raw_contains:
    - "timed out (service_start_timeout="
    - "Successfully activated service"

logging:
  enabled: true
  level: "info"
  path: "./data/siem_agent.log"

